
# Shield Security Plugin Vulnerability Exploit (CVE-2024-7313)

![Kali Linux](https://img.shields.io/badge/Kali%20Linux-Yes-blue?style=flat&logo=kalilinux)
![Works on My Machine](https://img.shields.io/badge/works-on%20my%20machine-green.svg)
![Sleep Deprivation](https://img.shields.io/badge/sleep-deprived-yellow.svg)


## Overview

This repository contains a Python script designed to exploit a reflected XSS vulnerability in the Shield Security Plugin for WordPress, affecting versions below 20.0.6. The vulnerability (CVE-2024-7313) allows an attacker to create an unauthorized admin account by exploiting a weakness in the plugin. The script automatically detects vulnerable installations and generates a payload to exploit the vulnerability.

## Vulnerability Information

- **CVE**: CVE-2024-7313
- **Plugin**: Shield Security < 20.0.6
- **Severity**: High
- **Affected Systems**: WordPress websites using Shield Security plugin versions < 20.0.6
- **Attack Type**: Reflected Cross-Site Scripting (XSS)
- **Discovered By**: Wayne-Kerr
- **Published Date**: August 7, 2024
- **OWASP TOP-10**: A7: Cross-Site Scripting (XSS)

## Usage

### Prerequisites

- Python 3.x
- `requests` and `beautifulsoup4` libraries

Install the required libraries using:

```bash
pip install requests beautifulsoup4
```

### Running the Script

1. Clone the repository:

```bash
git clone https://github.com/yourusername/shield-security-vulnerability-exploit.git
cd shield-security-vulnerability-exploit
```

2. Run the script with the target URL:

```bash
python3 exploit.py <target_url>
```

Example:

```bash
python3 exploit.py http://example.com
```

3. The script will check if the target is vulnerable, and if so, it will prompt you to enter details for the admin account to be created (username, email, first name, last name).

4. The script will then generate an XSS payload URL that you can use to exploit the vulnerability.

### Help Menu

You can access the help menu by running:

```bash
python3 exploit.py -h
```

### Dork to Find Vulnerable Sites

To identify websites that are using the vulnerable plugin, you can use the following dork:

```
inurl:"/wp-content/plugins/wp-simple-firewall/"
```

This will help you find websites that have the Shield Security plugin installed. Please note that the version number is not publicly visible, so manual testing may be required.

## Example Output

```
###############################################################
#    Shield Security Plugin Vulnerability (CVE-2024-7313)      #
#    Reflected XSS in WordPress Shield Security Plugin         #
#    Versions Affected: < 20.0.6                               #
#    Risk: High                                                #
#    Discovered by: Wayne-Kerr                                 #
#    Published: August 7, 2024                                 #
############################################################### 

Enter username: admin
Enter email: admin@example.com
Enter first name: John
Enter last name: Doe

Using hardcoded password: HaxorStrongAFPassword123!!

Generated XSS Payload URL: http://example.com/wp-admin/admin.php?page=icwp-wpsf-plugin&nav=dashboard&nav_sub=...
```

## How It Works

- The script first checks if the target WordPress installation is using a vulnerable version of the Shield Security plugin by examining the response from the `wp-login.php` page.
- If the plugin version is vulnerable, it proceeds to generate a reflected XSS payload that, when executed, will create a new admin user with a hardcoded password.
- The payload is then URL-encoded and displayed for use in the attack.

## Disclaimer

This tool is intended for educational purposes only and should only be used in authorized penetration testing environments. Unauthorized access or use of systems you do not own is illegal. The author is not responsible for any misuse of this tool.

## License

This project is licensed under the MIT License.
